<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pandora's Logs</title>
    <style>
        body { background: #0f0f13; color: #e4e4e7; font-family: monospace; padding: 2rem; }
        table { width: 100%; border-collapse: collapse; border: 1px solid #27272a; }
        th, td { border: 1px solid #27272a; padding: 10px; text-align: left; }
        th { background: #18181b; color: #10b981; }
        tr:nth-child(even) { background: #18181b; }
        
        .alert { color: #ef4444; font-weight: bold; }
        .normal { color: #a1a1aa; }
        a { color: #10b981; text-decoration: none; }

        /* MATRIX LOADER */
        #loader-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0f0f13; z-index: 9999; display: flex; justify-content: center; align-items: center; transition: opacity 0.5s ease-out; }
        .loader-hidden { opacity: 0; pointer-events: none; }

        .ai-matrix-loader { width: 120px; height: 160px; position: relative; perspective: 800px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; }
        .digit { color: #00ff88; font-family: monospace; font-size: 18px; text-align: center; text-shadow: 0 0 5px #00ff88; animation: matrix-fall 2s infinite, matrix-flicker 0.5s infinite; opacity: 0; }
        .digit:nth-child(1) { animation-delay: 0.1s; } .digit:nth-child(2) { animation-delay: 0.3s; } .digit:nth-child(3) { animation-delay: 0.5s; }
        .digit:nth-child(4) { animation-delay: 0.7s; } .digit:nth-child(5) { animation-delay: 0.9s; } .digit:nth-child(6) { animation-delay: 1.1s; }
        .digit:nth-child(7) { animation-delay: 1.3s; } .digit:nth-child(8) { animation-delay: 1.5s; }
        .glow { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle, rgba(0, 255, 136, 0.1) 0%, transparent 70%); animation: matrix-pulse 2s infinite; }
        
        @keyframes matrix-fall { 0% { transform: translateY(-50px) rotateX(90deg); opacity: 0; } 20%, 80% { transform: translateY(0) rotateX(0deg); opacity: 0.8; } 100% { transform: translateY(50px) rotateX(-90deg); opacity: 0; } }
        @keyframes matrix-flicker { 0%, 19%, 21%, 100% { opacity: 0.8; } 20% { opacity: 0.2; } }
        @keyframes matrix-pulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.7; } }
    </style>
    <script>
        window.addEventListener("load", () => setTimeout(() => document.getElementById("loader-overlay").classList.add("loader-hidden"), 800));
        function showLoader() { document.getElementById("loader-overlay").classList.remove("loader-hidden"); }
    </script>
</head>
<body>

    <div id="loader-overlay">
        <div class="ai-matrix-loader">
            <div class="digit">0</div><div class="digit">1</div><div class="digit">0</div>
            <div class="digit">1</div><div class="digit">1</div><div class="digit">0</div>
            <div class="digit">0</div><div class="digit">1</div>
            <div class="glow"></div>
        </div>
    </div>

    <h2>System Security Logs</h2>
    <a href="/" onclick="showLoader()"> << Return to Vault</a>
    <br><br>
    
    {% if logs %}
    <table>
        <thead>
            <tr><th>Timestamp</th><th>Archive ID</th><th>Operator</th><th>Event</th></tr>
        </thead>
        <tbody>
            {% for log in logs %}
            <tr>
                <td>{{ log['timestamp'] }}</td>
                <td>{{ log['filename'] }}</td>
                <td>
                    <span class="{{ 'alert' if log['actor_username'] != log['owner_username'] else 'normal' }}">
                        {{ log['actor_username'] }}
                    </span>
                </td>
                <td>{{ log['action'] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
        <p style="color: #a1a1aa">No audit records found.</p>
    {% endif %}
</body>
</html>